<ng-template #notebookItems let-group="group">
  <div class="notes" fxLayout="row wrap">
    <div *ngIf="!hasNotes" i18n>You haven't created any {{label.plural}} yet.</div>
    <notebook-item *ngFor="let note of group.items"
        [config]="config"
        [group]="group.name"
        [itemId]="note.localNotebookItemId"
        [isChooseMode]="insertArgs.insertMode"
        [note]="note"
        (onSelect)="select($event)"
        fxFlex="100"
        fxFlex.gt-xs="50">
    </notebook-item>
  </div>
</ng-template>

<ng-template #oneGroup>
  <div class="center">
    <ng-container *ngTemplateOutlet="notebookItems; context: {group: groups[0]}"></ng-container>
  </div>
</ng-template>

<ng-template #multipleGroups>
  <mat-tab-group [selectedIndex]="selectedTabIndex"
      (selectedIndexChange)="selectedTabIndex = $event"
      animationDuration="0ms">
    <mat-tab *ngFor="let group of groups" [disabled]="group.disabled" [label]="group.title">
      <div class="center">
        <ng-container *ngTemplateOutlet="notebookItems; context: {group: group}"></ng-container>
      </div>
    </mat-tab>
  </mat-tab-group>
</ng-template>

<div class="notebook-notes" [class.insert-mode]="insertArgs.insertMode">
  <ng-container *ngIf="mode !== 'classroomMonitor'">
    <mat-toolbar role="heading">
      <h4 *ngIf="insertArgs.insertMode" class="info" i18n>Select item to insert</h4>
      <h4 *ngIf="!insertArgs.insertMode">{{label.link}}</h4>
      <span fxFlex></span>
      <button (click)="close()"
          mat-icon-button
          i18n-aria-label
          attr.aria-label="Close {{label.link}}">
        <mat-icon class="secondary-text">close</mat-icon>
      </button>
    </mat-toolbar>
    <mat-divider></mat-divider>
    <div class="notes-wrapper">
      <ng-container [ngTemplateOutlet]="groups.length > 1 ? multipleGroups : oneGroup">
      </ng-container>
    </div>
    <button *ngIf="config.itemTypes.note.enableAddNote"
        class="new-note"
        mat-fab
        color="accent"
        i18n-aria-label
        attr.aria-label="Add {{config.itemTypes.note.label.singular}}"
        i18n-matTooltip
        matTooltip="Add {{config.itemTypes.note.label.singular}}"
        matTooltipPosition="above"
        (click)="addNote()">
      <mat-icon>add</mat-icon>
    </button>
  </ng-container>
  <div class="notes notes-grading" *ngIf="mode === 'classroomMonitor'">
    <ng-container *ngIf="hasNotes">
      <div *ngFor="let group of groups">
        <h4 *ngIf="groups.length > 1" class="group-header mat-body-2 secondary-text">{{group.title}}</h4>
        <div fxLayout="row wrap" fxLayoutAlign="start center">
          <notebook-item *ngFor="let note of group.items"
              [config]="config"
              [group]="group.name"
              [itemId]="note.localNotebookItemId"
              [isChooseMode]="insertArgs.insertMode"
              [note]="note"
              (onSelect)="select($event)"
              fxFlex="100"
              fxFlex.gt-xs="50"
              fxFlex.gt-sm="33"
              fxFlex.gt-md="25">
          </notebook-item>
        </div>
      </div>
    </ng-container>
    <p *ngIf="!hasNotes" i18n>
      Team hasn't created any {{label.plural}} yet.
    </p>
  </div>
</div>
